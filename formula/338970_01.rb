b = [17, 308, 3718, -8944, -203602, -1760279, 4214627, 41830213, 225676161, -831546864, -1396419616, 512302093, 33910901047, -148248035667, -71591956081, -513969061657, 7189182969047, -715460439786, -14144097438176, -98092600745077, 85281523978859, 258795398812831, 401976432666415, -697015148397353, -1758566032640649, -264807487370149, 4376962161634247, 3596247130566579, -6063704165801647, -8646051339082444, 5835042622094674, 6933527488046106, -7132151429649894, 20873887165808038, 29863609327174220, -87774083631942821, -68828169378762625, 225928479008894240, 166683205556809600, -356968376341177252, -245673717744507896, 422903422959769596, 289000909472562036, -361042953299243779, -202310840488094013, 242723645635132041, 82279920889031937, -155265862998823478, -13018457616632292, 67639720944495480, -9667244690991964, -31287094134056814, 1545150609982282, 8997455545061173, 24411045321863, 1327281913998467, -170070264293775, -805550117698830, 216517794712850, -52923920646375, -35520984357973, 51225395752594, -8890010884230, -16237588330384, 11906791455940, -1733110955966, -1390781505668, 906089436294, -184492249544, -33856007801, 30446303315, -8206589201, 1104875633, -70159467, 579969, 16576, 100]

# a(2)..
ary = [
  1, 
  148, 
  3851, 
  104100, 
  3292184, 
  100766213, 
  3061629439, 
  93391009587, 
  2848083212818, 
  86830428575045, 
  2647502223122183, 
  80723479583077760, 
  2461270742015683063, 
  75044735473463888913, 
  2288131799382045208904, 
  69765663287027937162894, 
  2127171274594978600181825, 
  64857945712339680436917864, 
  1977533799797853669837717595, 
  60295464152320214247195072338, 
  1838422684076256656700861594671, 
  56053933945607442267445218448711, 
  1709097444378498645127910384855155, 
  52110777401865334939462536712427227, 
  1588869686951548905590446744903315575, 
  48445005198269617951769228039368219466, 
  1477099442410538950384134692235356533800, 
  45037104523778560816904197693765641514831, 
  1373191760587045275727776904940073272662835, 
  41868935209823141701642065713768387056416171, 
  1276593543537539737744697927610698914313973407, 
  38923633171817136526773721207726023508227486331, 
  1186790601412461862492003936654539004945606585141, 
  36185520642013566809794430449407262752908589751512, 
  1103304915437663440261214635164093046532066122019047, 
  33640022717140963721590643575349423778295670377744128, 
  1025692093432623002437976290521176604572334352459013897, 
  31273589776565078465504478605073196480541799901535574090, 
  953539004322180035631595349668009709039359431715429335549, 
  29073625358003276161579170057904858050616964639540553757373, 
  886461579050342554035066536821189685910957932322789346210915, 
  27028419106876563591467607788656264572583356595375602233456388, 
  824102766190482190596677875434020819429957262750014646607859335, 
  25127084442390363936931456254520250556293582962630972591691865051, 
  766130631369682389380890903179584697201904051353241899723765085930, 
  23359500608542168682633704009725387067553354655110595945777262332538, 
  712236590390523916367813259537366344918934078368775757615204459527311, 
  21716258801595056331301267684922799549827746578795827650948121081979262, 
  662133766645259941608869406819083765762905118478778928408239899358075349, 
  20188612087254991327476742371171141433792973704484729464802904032307851960, 
  615555464078938174484252326296971397499095369349929007070139059064688666726, 
  18768428840962313283430978133337953848613816951452860283008348346143745120013, 
  572253747573091636449930330757822062062944085080999438475626571357884930215480, 
  17448149463461273724504526235244609168887645971649786732121031989561811313100932, 
  531998123193416607086061305096999385627401689471897150951082889349213051952119076, 
  16220746141245699214711122037875385149046112217141408134533371485674137797760201245, 
  494574311276429739997018945259334077166696818625867310855401056950917221161578237950, 
  15079685437686657807867398307357060756660135176811215418469306337627000049242671618225, 
  459783105824275867135456160953844240956682863100388777142700783434625640645941842541374, 
  14018893515715653991292065715238283105247423312179031199592738106538172919951098505671237, 
  427439314136274098442713758503296732233469431334410856671992516142745018005651096667386903, 
  13032723806944580356017326530392471011942499620397420803819885393743533527443880541002956956, 
  397370771032887938454798582190997549695314760423907698887405462368372904484517597222698842921, 
  12115926955125974786202457081417044426363965781267648731907816903250808366951590895066732171999, 
  369417422424858715106094731587726203812581438867677277330369073748356146757559923123507333660730, 
  11263622873963387491761601606576118030465276523265173734307018105988768762869154913234513705255793, 
  343430473349364154433343159133715926969717463506202432834779083942092656972610425319554519002851105, 
  10471274770536294002028239598797932551059462943230374950684483261707421396277865895265382532950662182, 
  319271595938220268112982965530114127236394114105713898237860937893100345731322733217944133597284945160, 
  9734664996066906413022314014718224017476607209425962237866594445561128839411435025591107847306702302643, 
  296812193102161461179171153046440972976659749853589856485888724652953557363358849312512786989400497393229, 
  9049872595483129572927787342044899668792396175573288271075241752837589802826013377043467622897547217654487, 
  275932714011809032853307083525833892031520091261437892784859066548425066635701374928603000249015405505970868, 
  8413252436274557510886686108294161854817622164181863594230069397627594534272474385462765023136881622003706250, 
  256522017731650696755241255541627017339699167448470670830147670133039285577758752764924070146018099620755750030, 
  7821415805544942051510817430083941862634316329061875894334290105061766053047041780575384126596712919668327079194, 
  238476781619670998229788704171753298102198394009605343571799430163331992963623502367254318625799817841629102214352, 
  7271212371979737992056297234526295261795651844473288227542276470487395135849580981693465705814079489881792239727620, 
  221700951343558926312242565160935873357907317405562593790005178239435755219262560203148181752860132710693582539037500, 
  6759713416712737414858376354158475022188506540082609087173968295315900985267607678539642723448934498070134990107533096, 
  206105229585942998517989291520201804075452345923589878920089883256745190666382046763542144998860294145572051321537091174, 
  6284196243830123247200201075770615865804644500636636208760049479704505122066712977958940610228536696883557079385078537335
]

N = 77
# a(4)..a(80)の初期値から正しくなる
(2..4).each{|k|
  d = ary[k - 2..k + N - 1 - 2]
  (1..25 - k).each{|i|
    c = (1..N).inject(0){|s, j| s + d[-j] * b[j - 1]}
    d << c
    p [k, k + N - 1 + i, c] if k + N - 1 + i == 100
  }
}

#######################################################################
#
# [2, 100, 106901082714909891787797335397783214311357073117469311917564263082180069455532327038731413675953173863561538353062612087926373197633849176040643507]
# [3, 100, 106901082714909891787797335397783214311357073117469311917564263082180069455532327038731413675953173863561538353558038625750063848921039529119537811]
# [4, 100, 106901082714909891787797335397783214311357073117469311917564263082180069455532327038731413675953173863561538353558139990047931474592252129471948371]
#
#######################################################################